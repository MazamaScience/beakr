<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A Minimalist Web Framework for R • beakr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="A Minimalist Web Framework for R">
<meta property="og:description" content="A minimalist web framework for developing application programming interfaces in R that provides a flexible framework for handling common HTTP-requests, errors, logging, and an ability to integrate any R code as server middle-ware.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">beakr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.4.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/MazamaScience/beakr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">


<p><a href="https://cran.r-project.org/package=beakr" class="external-link"><img src="https://www.r-pkg.org/badges/version/beakr" alt="CRAN_Status_Badge"></a> <a href="https://cran.r-project.org/package=beakr" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/beakr" alt="Downloads"></a></p>
<div class="section level2">
<h2 id="a-minimalist-web-framework-for-r">A Minimalist Web Framework for R<a class="anchor" aria-label="anchor" href="#a-minimalist-web-framework-for-r"></a>
</h2>
<p><strong>beakr</strong> is a minimalist web framework for developing web services in the R Language. <strong>beakr</strong> offers a robust set of fundamental web application features and is intended to simplify the development of web services that reflect R package APIs — without obscuring R’s data processing capability and ease of use.</p>
<p>A dedicated Slack channel has been created for announcements, support and to help build a community of practice around this open source package. You may request an invitation to join from <a href="mailto:jonathan.callahan@dri.com" class="email">jonathan.callahan@dri.com</a>.</p>
<div class="section level3">
<h3 id="hello-world---the-beakr-way">Hello, world! - The beakr way<a class="anchor" aria-label="anchor" href="#hello-world---the-beakr-way"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/MazamaScience/beakr" class="external-link">beakr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a new beakr server</span></span>
<span><span class="fu"><a href="reference/newBeakr.html">newBeakr</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span></span>
<span>  <span class="co"># Respond to GET requests at the "/hi" route</span></span>
<span>  <span class="fu"><a href="reference/httpGET.html">httpGET</a></span><span class="op">(</span>path <span class="op">=</span> <span class="st">"/hi"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">req</span>, <span class="va">res</span>, <span class="va">err</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Hello, World!"</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  </span>
<span>  <span class="co"># Respond to GET requests at the "/bye" route</span></span>
<span>  <span class="fu"><a href="reference/httpGET.html">httpGET</a></span><span class="op">(</span>path <span class="op">=</span> <span class="st">"/bye"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">req</span>, <span class="va">res</span>, <span class="va">err</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Farewell, my friends."</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span> </span>
<span>  </span>
<span>  <span class="co"># Handle any errors with a JSON response</span></span>
<span>  <span class="fu"><a href="reference/handleErrors.html">handleErrors</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  </span>
<span>  <span class="co"># Start the server on port 25118</span></span>
<span>  <span class="fu"><a href="reference/listen.html">listen</a></span><span class="op">(</span>host <span class="op">=</span> <span class="st">"127.0.0.1"</span>, port <span class="op">=</span> <span class="fl">25118</span><span class="op">)</span> </span></code></pre></div>
<p>A new web service is now available on the local host that responds to two URLs:</p>
<ul>
<li><a href="http://127.0.0.1:25118/hi" class="external-link uri">http://127.0.0.1:25118/hi</a></li>
<li><a href="http://127.0.0.1:25118/bye" class="external-link uri">http://127.0.0.1:25118/bye</a></li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The <strong>beakr</strong> package allows R code to listen for and respond to HTTP requests, so you can serve web traffic directly from a <em>Beakr</em> instance. The <strong>beakr</strong> package is intended to be simple, lightweight and unopinionated.</p>
<p>While <strong>beakr</strong> is not recommended for building extensive web frameworks, R and the flexibility of the package are (potentially) up to the task. Keep in mind that <strong>beakr</strong> was not designed to be an especially performant web framework and the <em>“batteries are certainly not included”</em>. If you’re looking for full featured web frameworks, there are better tools and languages for that (see <a href="https://shiny.posit.co" class="external-link">Shiny</a>, <a href="https://www.djangoproject.com" class="external-link">django</a>, etc.). <strong>beakr</strong> is inspired by the minimalist and massively-expandable frameworks offered by <a href="https://expressjs.com" class="external-link">Express.js</a> and <a href="https://palletsprojects.com/p/flask" class="external-link">Flask</a>.</p>
<p>One of the reasons to use <strong>beakr</strong> is that it is incredibly flexible. It allows you to integrate your R code as <em>Middleware</em> in a <em>Beakr</em> instance. Middleware functions can execute any R code, make changes to the <em>Request</em>, <em>Response</em>, and <em>Error</em> objects, and then serve up the response at the end the request-response cycle. The <strong>beakr</strong> package loosely follows Express.js middleware semantics, where middleware functions are functions that have access to the <em>Request</em>, <em>Response</em>, and <em>Error</em> objects of a <em>Beakr</em> instance.</p>
<p><em>Note:</em> By convention, the <em>Response</em>, <em>Request</em>, and <em>Error</em> objects are always referred to as <code>res</code>, <code>req</code> and <code>err</code>, respectively. See the package documentation for more information.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>When released, you will be able to install the latest release version from CRAN:</p>
<pre><code><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"beakr"</span><span class="op">)</span></span></code></pre>
<p>Or you can install the latest development version from GitHub:</p>
<pre><code><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"MazamaScience/beakr"</span><span class="op">)</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<div class="section level3">
<h3 id="a-knn-model-webservice">A KNN model webservice<a class="anchor" aria-label="anchor" href="#a-knn-model-webservice"></a>
</h3>
<p>A <em>Beakr</em> instance can easily expose R function signatures as webservice APIs. As an example, let’s expose a simple machine learning model using the <a href="https://github.com/topepo/caret" class="external-link">caret</a> package and the Iris data set. The <code>predict_species()</code> function accepts four arguments which it uses to predict the species of iris associated with incoming data. The <em>Beakr</em> instance exposes this API and, when given JSON input with the required arguments, identifies and returns the species.</p>
<p><em>Note</em> that <code>httpPOST</code> attaches the URL path <code>/predict-species</code> only to http POST requests. Pointing a browser at this URL path will issue a File Not found error because the browser is issuing an http GET request. Like other frameworks, <strong>beakr</strong> allows for method-specific URL routing.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Import libraries </span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/MazamaScience/beakr" class="external-link">beakr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/topepo/caret/" class="external-link">caret</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load the Iris data set </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">'iris'</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Train using KNN</span></span>
<span><span class="va">knn_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/train.html" class="external-link">train</a></span><span class="op">(</span></span>
<span>  <span class="va">Species</span> <span class="op">~</span> <span class="va">.</span>, </span>
<span>  data <span class="op">=</span> <span class="va">iris</span>, </span>
<span>  method <span class="op">=</span> <span class="st">'knn'</span>, </span>
<span>  trControl <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/caret/man/trainControl.html" class="external-link">trainControl</a></span><span class="op">(</span>method<span class="op">=</span><span class="st">'cv'</span>, number<span class="op">=</span><span class="fl">10</span><span class="op">)</span>, </span>
<span>  metric <span class="op">=</span> <span class="st">'Accuracy'</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Function to predict the species using the trained model.</span></span>
<span><span class="va">predict_species</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">sl</span>, <span class="va">sw</span>, <span class="va">pl</span>, <span class="va">pw</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    Sepal.Length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">sl</span><span class="op">)</span>,</span>
<span>    Sepal.Width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">sw</span><span class="op">)</span>,</span>
<span>    Petal.Length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">pl</span><span class="op">)</span>,</span>
<span>    Petal.Width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">pw</span><span class="op">)</span>,</span>
<span>    Species <span class="op">=</span> <span class="cn">NA</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">knn_model</span>, <span class="va">test</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Use beakr to expose the model in the "/predict-species" url path.</span></span>
<span><span class="co">#   See help("decorate") for more info about decorating functions.</span></span>
<span><span class="fu"><a href="reference/newBeakr.html">newBeakr</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="reference/httpPOST.html">httpPOST</a></span><span class="op">(</span>path <span class="op">=</span> <span class="st">"/predict-species"</span>, <span class="fu"><a href="reference/decorate.html">decorate</a></span><span class="op">(</span><span class="va">predict_species</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="reference/handleErrors.html">handleErrors</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="reference/listen.html">listen</a></span><span class="op">(</span>host <span class="op">=</span> <span class="st">"127.0.0.1"</span>, port <span class="op">=</span> <span class="fl">25118</span><span class="op">)</span></span></code></pre></div>
<p>You can interact with this webservice by sending an HTTP POST request to<br><code>http://127.0.0.1:25118/predict-species</code> with incoming data supplied as a JSON string containing sepal length and width (<code>sl</code>, <code>sw</code>) and petal length and width (<code>pl</code>, <code>pw</code>). The <em>Beakr</em> instance responds with the predicted species of iris.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="ex">$</span> curl <span class="at">-X</span> POST http://127.0.0.1:25118/predict-species <span class="dt">\</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>  <span class="at">-H</span> <span class="st">'content-type: application/json'</span> <span class="dt">\</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>  <span class="at">-d</span> <span class="st">'{ "sl": 5.3, "sw": 4, "pl": 1.6, "pw": 0.2 }'</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>  </span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="op">&gt;</span> setosa</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="a-state-plotting-webservice">A state plotting webservice<a class="anchor" aria-label="anchor" href="#a-state-plotting-webservice"></a>
</h3>
<p>We can use a built-in convenience function of a <strong>beakr</strong>’s <em>Response</em> object to print and return a <em>ggplot</em> object. Use <code><a href="reference/Response.html">help("Response")</a></code> to view other <em>Response</em> object methods and documentation. In this example we’ll wrap some map generation code and serve it with a <em>Beakr</em> instance. Instead of decorating an existing package function, we will create a <strong>beakr</strong>-oriented function that uses a response object method to send back raw image bytes. Parameters in the URL request will be converted into arguments to the function.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/MazamaScience/beakr" class="external-link">beakr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a plot of a US state</span></span>
<span><span class="va">state_plot</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">state</span> <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">res</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">states</span> <span class="op">&lt;-</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/map_data.html" class="external-link">map_data</a></span><span class="op">(</span><span class="st">'state'</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">state</span><span class="op">)</span> <span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">states</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">states</span>, <span class="va">region</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">tolower</a></span><span class="op">(</span><span class="va">state</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="va">plot</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">states</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_polygon.html" class="external-link">geom_polygon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">long</span>, y <span class="op">=</span> <span class="va">lat</span>, fill <span class="op">=</span> <span class="va">region</span>, group <span class="op">=</span> <span class="va">group</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_fixed</a></span><span class="op">(</span><span class="fl">1.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html" class="external-link">guides</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Pass the plot to the beakrs response plot method</span></span>
<span>  <span class="va">res</span><span class="op">$</span><span class="fu">plot</span><span class="op">(</span><span class="va">plot</span>, base64 <span class="op">=</span> <span class="cn">FALSE</span>, height <span class="op">=</span> <span class="fl">800</span>, width <span class="op">=</span> <span class="fl">800</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Create and start a default beakr instance</span></span>
<span><span class="fu"><a href="reference/newBeakr.html">newBeakr</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="reference/httpGET.html">httpGET</a></span><span class="op">(</span>path <span class="op">=</span> <span class="st">'/usa'</span>, <span class="fu"><a href="reference/decorate.html">decorate</a></span><span class="op">(</span><span class="va">state_plot</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="reference/listen.html">listen</a></span><span class="op">(</span>host <span class="op">=</span> <span class="st">"127.0.0.1"</span>, port <span class="op">=</span> <span class="fl">8080</span><span class="op">)</span></span></code></pre></div>
<p>View a map of Washington state by visiting: <a href="http://127.0.0.1:8080/usa?state=washington" class="external-link uri">http://127.0.0.1:8080/usa?state=washington</a>.</p>
</div>
<div class="section level3">
<h3 id="a-custom-webservice">A custom webservice<a class="anchor" aria-label="anchor" href="#a-custom-webservice"></a>
</h3>
<p>Users can create custom functions that will be run when specific URLs are accessed using specific HTTP methods. The following example provides a basic outline for creating more complex webservices:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/MazamaScience/beakr" class="external-link">beakr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/MazamaScience/MazamaCoreUtils" class="external-link">MazamaCoreUtils</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/newBeakr.html">newBeakr</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span></span>
<span>  <span class="co"># ----- Welcome --------------------------------------------------------------</span></span>
<span></span>
<span>  <span class="fu"><a href="reference/httpGET.html">httpGET</a></span><span class="op">(</span><span class="st">"/"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">req</span>, <span class="va">res</span>, <span class="va">err</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>    <span class="va">response</span> <span class="op">&lt;-</span></span>
<span><span class="st">"</span></span>
<span><span class="st">&lt;html&gt;</span></span>
<span><span class="st">&lt;body&gt;</span></span>
<span><span class="st">&lt;h1&gt;Welcome to repeater!&lt;/h1&gt;</span></span>
<span><span class="st">&lt;p&gt;URL paths look like &lt;code&gt;/repeater?text=...&amp;amp;times=...&amp;amp;responseType=...&lt;/code&gt;&lt;/p&gt;</span></span>
<span><span class="st">&lt;p&gt;The following &lt;code&gt;responseTypes&lt;/code&gt; are supported:&lt;/p&gt;</span></span>
<span><span class="st">&lt;ul&gt;</span></span>
<span><span class="st">&lt;li&gt;&lt;code&gt;txt&lt;/code&gt;&lt;/li&gt;</span></span>
<span><span class="st">&lt;li&gt;&lt;code&gt;json&lt;/code&gt;&lt;/li&gt;</span></span>
<span><span class="st">&lt;/ul&gt;</span></span>
<span><span class="st">&lt;/body&gt;</span></span>
<span><span class="st">&lt;/html&gt;</span></span>
<span><span class="st">"</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">response</span><span class="op">)</span></span>
<span></span>
<span>  <span class="op">}</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span></span>
<span>  <span class="co"># ----- Repeater -------------------------------------------------------------</span></span>
<span></span>
<span>  <span class="fu"><a href="reference/httpGET.html">httpGET</a></span><span class="op">(</span><span class="st">"/repeater"</span>, <span class="kw">function</span><span class="op">(</span><span class="va">req</span>, <span class="va">res</span>, <span class="va">err</span><span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>    <span class="va">text</span> <span class="op">&lt;-</span> <span class="fu">MazamaCoreUtils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MazamaCoreUtils/man/setIfNull.html" class="external-link">setIfNull</a></span><span class="op">(</span><span class="va">req</span><span class="op">$</span><span class="va">parameters</span><span class="op">$</span><span class="va">text</span>, <span class="st">"Howdy"</span><span class="op">)</span></span>
<span>    <span class="va">times</span> <span class="op">&lt;-</span> <span class="fu">MazamaCoreUtils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MazamaCoreUtils/man/setIfNull.html" class="external-link">setIfNull</a></span><span class="op">(</span><span class="va">req</span><span class="op">$</span><span class="va">parameters</span><span class="op">$</span><span class="va">times</span>, <span class="fl">8</span><span class="op">)</span></span>
<span>    <span class="va">responseType</span> <span class="op">&lt;-</span> <span class="fu">MazamaCoreUtils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MazamaCoreUtils/man/setIfNull.html" class="external-link">setIfNull</a></span><span class="op">(</span><span class="va">req</span><span class="op">$</span><span class="va">parameters</span><span class="op">$</span><span class="va">responseType</span>, <span class="st">"txt"</span><span class="op">)</span></span>
<span></span>
<span>    <span class="kw">if</span> <span class="op">(</span> <span class="va">times</span> <span class="op">&gt;</span> <span class="fl">10</span> <span class="op">)</span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Parameter 'times' must be &lt; 10"</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">res</span><span class="op">$</span><span class="fu">setContentType</span><span class="op">(</span><span class="fu">mime</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/mime/man/mimemap.html" class="external-link">mimemap</a></span><span class="op">[</span><span class="va">responseType</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span>    <span class="kw">if</span> <span class="op">(</span> <span class="va">responseType</span> <span class="op">==</span> <span class="st">"txt"</span> <span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>      <span class="va">response</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">text</span>, <span class="va">times</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span></span>
<span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span> <span class="va">responseType</span> <span class="op">==</span> <span class="st">"json"</span> <span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>      <span class="va">responseList</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>        status <span class="op">=</span> <span class="st">"success"</span>,</span>
<span>        output <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">text</span>, <span class="va">times</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span></span>
<span>      <span class="va">response</span> <span class="op">&lt;-</span> <span class="fu">jsonlite</span><span class="fu">::</span><span class="fu"><a href="https://jeroen.r-universe.dev/jsonlite/reference/fromJSON.html" class="external-link">toJSON</a></span><span class="op">(</span></span>
<span>        <span class="va">responseList</span>,</span>
<span>        na <span class="op">=</span> <span class="st">"null"</span>,</span>
<span>        pretty <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        auto_unbox <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>      <span class="op">)</span></span>
<span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span> <span class="va">responseType</span> <span class="op">==</span> <span class="st">"png"</span> <span class="op">)</span> <span class="op">{</span></span>
<span></span>
<span>      <span class="va">pngFile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"repeater"</span>, fileext <span class="op">=</span> <span class="st">"png"</span><span class="op">)</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/grDevices/png.html" class="external-link">png</a></span><span class="op">(</span><span class="va">pngFile</span><span class="op">)</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">11</span>,<span class="fl">0</span><span class="op">:</span><span class="fl">11</span>, col <span class="op">=</span> <span class="st">"transparent"</span>, axes <span class="op">=</span> <span class="cn">FALSE</span>, xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span>      <span class="kw">for</span> <span class="op">(</span> <span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">times</span> <span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span> <span class="op">-</span> <span class="va">i</span>, <span class="va">text</span><span class="op">)</span></span>
<span>      <span class="op">}</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off</a></span><span class="op">(</span><span class="op">)</span></span>
<span>      <span class="va">response</span> <span class="op">&lt;-</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_file.html" class="external-link">read_file_raw</a></span><span class="op">(</span><span class="va">pngFile</span><span class="op">)</span></span>
<span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"responseType 'responseType' is not recognized"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>    <span class="op">}</span></span>
<span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">response</span><span class="op">)</span></span>
<span></span>
<span>  <span class="op">}</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span></span>
<span>  <span class="co"># ----- Handle errors --------------------------------------------------------</span></span>
<span></span>
<span>  <span class="fu"><a href="reference/handleErrors.html">handleErrors</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span></span>
<span>  <span class="co"># ----- Start Beakr ----------------------------------------------------------</span></span>
<span></span>
<span>  <span class="fu"><a href="reference/listen.html">listen</a></span><span class="op">(</span>host <span class="op">=</span> <span class="st">"127.0.0.1"</span>, port <span class="op">=</span> <span class="fl">8080</span><span class="op">)</span></span></code></pre></div>
<p>View the repeater API by visiting: <a href="http://127.0.0.1:8080" class="external-link uri">http://127.0.0.1:8080</a>.</p>
</div>
</div>
<div class="section level2">
<h2 id="notes">Notes<a class="anchor" aria-label="anchor" href="#notes"></a>
</h2>
<p>Fundamentally, <strong>beakr</strong> is built on top of the <strong>libuv</strong> and <strong>http-parser</strong> C libraries as beakr relies heavily upon <a href="https://github.com/rstudio/httpuv" class="external-link">httpuv</a>, a package that provides low-level socket and protocol support for handling HTTP and WebSocket requests directly from within R. Much of the development of the package was inspired by the excellent but no longer supported <a href="https://github.com/Bart6114/jug" class="external-link">jug</a> package, developed by Bart Smeets.</p>
<hr>
<p>The beakr package is supported by <a href="http://mazamascience.com/" class="external-link">Mazama Science</a>.</p>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=beakr" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/MazamaScience/beakr/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/MazamaScience/beakr/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing beakr</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Hans Martin <br><small class="roles"> Author </small>  </li>
<li>Jonathan Callahan <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://postimg.cc/bstHjjMT" class="external-link"><img src="https://i.postimg.cc/7YBB0Hnp/sm-beakr.png" alt="sm-beakr.png"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Hans Martin, Jonathan Callahan.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
